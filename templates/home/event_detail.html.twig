{% extends 'base.html.twig' %}

{% block title %}{{ evenement.titre }} - Qataa3.ma{% endblock %}

{% block body %}
<div class="container py-5">
    <div class="row">
        <div class="col-md-8">
            <!-- Image de l'événement -->
            {% if evenement.image %}
                <img src="{{ asset('images/events/' ~ evenement.image) }}" class="img-fluid rounded shadow-sm mb-4" alt="{{ evenement.titre }}">
            {% else %}
                <div class="bg-gradient text-white d-flex align-items-center justify-content-center rounded shadow-sm mb-4" style="height: 400px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                    <i class="fas fa-calendar-alt fa-5x"></i>
                </div>
            {% endif %}

            <h1 class="mb-3">{{ evenement.titre }}</h1>
            
            <div class="mb-4">
                <span class="badge bg-primary fs-6">{{ evenement.categorie }}</span>
                <span class="badge bg-success fs-6">{{ evenement.statut|upper }}</span>
            </div>

            <div class="mb-4">
                <h5><i class="fas fa-info-circle text-primary"></i> Description</h5>
                <p class="text-muted">{{ evenement.description }}</p>
            </div>

            <div class="card mb-4">
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <h6><i class="fas fa-calendar text-primary"></i> Date et Heure</h6>
                            <p class="mb-0">{{ evenement.dateEvenement|date('d/m/Y à H:i') }}</p>
                        </div>
                        <div class="col-md-6 mb-3">
                            <h6><i class="fas fa-map-marker-alt text-primary"></i> Lieu</h6>
                            <p class="mb-0">{{ evenement.lieu }}</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sidebar - Types de billets -->
        <div class="col-md-4">
            <div class="card shadow-sm sticky-top" style="top: 20px;">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0"><i class="fas fa-ticket-alt"></i> Billets disponibles</h5>
                </div>
                <div class="card-body">
                    {% if evenement.typeBillets is empty %}
                        <p class="text-muted text-center">Aucun billet disponible</p>
                    {% else %}
                        {% for billet in evenement.typeBillets %}
                            {% if billet.statut == 'actif' and billet.quantiteRestante > 0 %}
                                <div class="border rounded p-3 mb-3">
                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                        <h6 class="mb-0">{{ billet.nomType }}</h6>
                                        <span class="badge bg-primary">{{ billet.quantiteRestante }} restants</span>
                                    </div>
                                    <p class="h4 text-primary mb-3">
                                        {% if billet.prix == 0 %}
                                            Gratuit
                                        {% else %}
                                            {{ billet.prix }} MAD
                                        {% endif %}
                                    </p>
                                    <form action="{{ path('app_cart_add', {id: billet.id}) }}" method="post">
    <div class="input-group mb-2">
        <input type="number" name="quantite" value="1" min="1" max="{{ billet.quantiteRestante }}" class="form-control">
        <button type="submit" class="btn btn-primary">
            <i class="fas fa-shopping-cart"></i> Ajouter
        </button>
    </div>
</form>

                                </div>
                            {% endif %}
                        {% endfor %}
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
